  <TestCase name="getExecPlan[q64]">
    <Resource name="sql">
      <![CDATA[/*
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

-- start query 1 in stream 0 using template query64.tpl and seed 1220860970
with cs_ui as
 (select cs_item_sk
        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund
  from catalog_sales
      ,catalog_returns
  where cs_item_sk = cr_item_sk
    and cs_order_number = cr_order_number
  group by cs_item_sk
  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),
cross_sales as
 (select i_product_name product_name
     ,i_item_sk item_sk
     ,s_store_name store_name
     ,s_zip store_zip
     ,ad1.ca_street_number b_street_number
     ,ad1.ca_street_name b_streen_name
     ,ad1.ca_city b_city
     ,ad1.ca_zip b_zip
     ,ad2.ca_street_number c_street_number
     ,ad2.ca_street_name c_street_name
     ,ad2.ca_city c_city
     ,ad2.ca_zip c_zip
     ,d1.d_year as syear
     ,d2.d_year as fsyear
     ,d3.d_year s2year
     ,count(*) cnt
     ,sum(ss_wholesale_cost) s1
     ,sum(ss_list_price) s2
     ,sum(ss_coupon_amt) s3
  FROM   store_sales
        ,store_returns
        ,cs_ui
        ,date_dim d1
        ,date_dim d2
        ,date_dim d3
        ,store
        ,customer
        ,customer_demographics cd1
        ,customer_demographics cd2
        ,promotion
        ,household_demographics hd1
        ,household_demographics hd2
        ,customer_address ad1
        ,customer_address ad2
        ,income_band ib1
        ,income_band ib2
        ,item
  WHERE  ss_store_sk = s_store_sk AND
         ss_sold_date_sk = d1.d_date_sk AND
         ss_customer_sk = c_customer_sk AND
         ss_cdemo_sk= cd1.cd_demo_sk AND
         ss_hdemo_sk = hd1.hd_demo_sk AND
         ss_addr_sk = ad1.ca_address_sk and
         ss_item_sk = i_item_sk and
         ss_item_sk = sr_item_sk and
         ss_ticket_number = sr_ticket_number and
         ss_item_sk = cs_ui.cs_item_sk and
         c_current_cdemo_sk = cd2.cd_demo_sk AND
         c_current_hdemo_sk = hd2.hd_demo_sk AND
         c_current_addr_sk = ad2.ca_address_sk and
         c_first_sales_date_sk = d2.d_date_sk and
         c_first_shipto_date_sk = d3.d_date_sk and
         ss_promo_sk = p_promo_sk and
         hd1.hd_income_band_sk = ib1.ib_income_band_sk and
         hd2.hd_income_band_sk = ib2.ib_income_band_sk and
         cd1.cd_marital_status <> cd2.cd_marital_status and
         i_color in ('maroon','burnished','dim','steel','navajo','chocolate') and
         i_current_price between 35 and 35 + 10 and
         i_current_price between 35 + 1 and 35 + 15
group by i_product_name
       ,i_item_sk
       ,s_store_name
       ,s_zip
       ,ad1.ca_street_number
       ,ad1.ca_street_name
       ,ad1.ca_city
       ,ad1.ca_zip
       ,ad2.ca_street_number
       ,ad2.ca_street_name
       ,ad2.ca_city
       ,ad2.ca_zip
       ,d1.d_year
       ,d2.d_year
       ,d3.d_year
)
select cs1.product_name
     ,cs1.store_name
     ,cs1.store_zip
     ,cs1.b_street_number
     ,cs1.b_streen_name
     ,cs1.b_city
     ,cs1.b_zip
     ,cs1.c_street_number
     ,cs1.c_street_name
     ,cs1.c_city
     ,cs1.c_zip
     ,cs1.syear
     ,cs1.cnt
     ,cs1.s1
     ,cs1.s2
     ,cs1.s3
     ,cs2.s1
     ,cs2.s2
     ,cs2.s3
     ,cs2.syear
     ,cs2.cnt
from cross_sales cs1,cross_sales cs2
where cs1.item_sk=cs2.item_sk and
     cs1.syear = 2000 and
     cs2.syear = 2000 + 1 and
     cs2.cnt <= cs1.cnt and
     cs1.store_name = cs2.store_name and
     cs1.store_zip = cs2.store_zip
order by cs1.product_name
       ,cs1.store_name
       ,cs2.cnt

-- end query 1 in stream 0 using template query64.tpl
]]>
    </Resource>
    <Resource name="ast">
      <![CDATA[
LogicalSort(sort0=[$0], sort1=[$1], sort2=[$20], dir0=[ASC-nulls-first], dir1=[ASC-nulls-first], dir2=[ASC-nulls-first])
+- LogicalProject(product_name=[$0], store_name=[$2], store_zip=[$3], b_street_number=[$4], b_streen_name=[$5], b_city=[$6], b_zip=[$7], c_street_number=[$8], c_street_name=[$9], c_city=[$10], c_zip=[$11], syear=[$12], cnt=[$15], s1=[$16], s2=[$17], s3=[$18], s10=[$35], s20=[$36], s30=[$37], syear0=[$31], cnt0=[$34])
   +- LogicalFilter(condition=[AND(=($1, $20), =($12, 2000), =($31, +(2000, 1)), <=($34, $15), =($2, $21), =($3, $22))])
      +- LogicalJoin(condition=[true], joinType=[inner])
         :- LogicalAggregate(group=[{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14}], cnt=[COUNT()], s1=[SUM($15)], s2=[SUM($16)], s3=[SUM($17)])
         :  +- LogicalProject(product_name=[$277], item_sk=[$256], store_name=[$135], store_zip=[$155], b_street_number=[$226], b_streen_name=[$227], b_city=[$230], b_zip=[$233], c_street_number=[$239], c_street_name=[$240], c_city=[$243], c_zip=[$246], syear=[$52], fsyear=[$80], s2year=[$108], ss_wholesale_cost=[$10], ss_list_price=[$11], ss_coupon_amt=[$18])
         :     +- LogicalFilter(condition=[AND(=($6, $130), =($22, $46), =($2, $159), =($3, $177), =($4, $214), =($5, $224), =($1, $256), =($1, $24), =($8, $31), =($1, $43), =($161, $186), =($162, $219), =($163, $237), =($165, $74), =($164, $102), =($7, $195), =($215, $250), =($220, $253), <>($179, $188), OR(=($273, _UTF-16LE'maroon'), =($273, _UTF-16LE'burnished'), =($273, _UTF-16LE'dim'), =($273, _UTF-16LE'steel'), =($273, _UTF-16LE'navajo'), =($273, _UTF-16LE'chocolate')), >=($261, 35), <=($261, +(35, 10)), >=($261, +(35, 1)), <=($261, +(35, 15)))])
         :        +- LogicalJoin(condition=[true], joinType=[inner])
         :           :- LogicalJoin(condition=[true], joinType=[inner])
         :           :  :- LogicalJoin(condition=[true], joinType=[inner])
         :           :  :  :- LogicalJoin(condition=[true], joinType=[inner])
         :           :  :  :  :- LogicalJoin(condition=[true], joinType=[inner])
         :           :  :  :  :  :- LogicalJoin(condition=[true], joinType=[inner])
         :           :  :  :  :  :  :- LogicalJoin(condition=[true], joinType=[inner])
         :           :  :  :  :  :  :  :- LogicalJoin(condition=[true], joinType=[inner])
         :           :  :  :  :  :  :  :  :- LogicalJoin(condition=[true], joinType=[inner])
         :           :  :  :  :  :  :  :  :  :- LogicalJoin(condition=[true], joinType=[inner])
         :           :  :  :  :  :  :  :  :  :  :- LogicalJoin(condition=[true], joinType=[inner])
         :           :  :  :  :  :  :  :  :  :  :  :- LogicalJoin(condition=[true], joinType=[inner])
         :           :  :  :  :  :  :  :  :  :  :  :  :- LogicalJoin(condition=[true], joinType=[inner])
         :           :  :  :  :  :  :  :  :  :  :  :  :  :- LogicalJoin(condition=[true], joinType=[inner])
         :           :  :  :  :  :  :  :  :  :  :  :  :  :  :- LogicalJoin(condition=[true], joinType=[inner])
         :           :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- LogicalJoin(condition=[true], joinType=[inner])
         :           :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- LogicalJoin(condition=[true], joinType=[inner])
         :           :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, store_sales]])
         :           :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, store_returns]])
         :           :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- LogicalFilter(condition=[>($1, *(2, $2))])
         :           :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- LogicalAggregate(group=[{0}], sale=[SUM($1)], refund=[SUM($2)])
         :           :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- LogicalProject(cs_item_sk=[$14], cs_ext_list_price=[$24], $f2=[+(+($56, $57), $58)])
         :           :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- LogicalFilter(condition=[AND(=($14, $35), =($16, $49))])
         :           :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- LogicalJoin(condition=[true], joinType=[inner])
         :           :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 :- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, catalog_sales]])
         :           :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, catalog_returns]])
         :           :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, date_dim]])
         :           :  :  :  :  :  :  :  :  :  :  :  :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, date_dim]])
         :           :  :  :  :  :  :  :  :  :  :  :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, date_dim]])
         :           :  :  :  :  :  :  :  :  :  :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, store]])
         :           :  :  :  :  :  :  :  :  :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, customer]])
         :           :  :  :  :  :  :  :  :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, customer_demographics]])
         :           :  :  :  :  :  :  :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, customer_demographics]])
         :           :  :  :  :  :  :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, promotion]])
         :           :  :  :  :  :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, household_demographics]])
         :           :  :  :  :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, household_demographics]])
         :           :  :  :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, customer_address]])
         :           :  :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, customer_address]])
         :           :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, income_band]])
         :           :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, income_band]])
         :           +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, item]])
         +- LogicalAggregate(group=[{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14}], cnt=[COUNT()], s1=[SUM($15)], s2=[SUM($16)], s3=[SUM($17)])
            +- LogicalProject(product_name=[$277], item_sk=[$256], store_name=[$135], store_zip=[$155], b_street_number=[$226], b_streen_name=[$227], b_city=[$230], b_zip=[$233], c_street_number=[$239], c_street_name=[$240], c_city=[$243], c_zip=[$246], syear=[$52], fsyear=[$80], s2year=[$108], ss_wholesale_cost=[$10], ss_list_price=[$11], ss_coupon_amt=[$18])
               +- LogicalFilter(condition=[AND(=($6, $130), =($22, $46), =($2, $159), =($3, $177), =($4, $214), =($5, $224), =($1, $256), =($1, $24), =($8, $31), =($1, $43), =($161, $186), =($162, $219), =($163, $237), =($165, $74), =($164, $102), =($7, $195), =($215, $250), =($220, $253), <>($179, $188), OR(=($273, _UTF-16LE'maroon'), =($273, _UTF-16LE'burnished'), =($273, _UTF-16LE'dim'), =($273, _UTF-16LE'steel'), =($273, _UTF-16LE'navajo'), =($273, _UTF-16LE'chocolate')), >=($261, 35), <=($261, +(35, 10)), >=($261, +(35, 1)), <=($261, +(35, 15)))])
                  +- LogicalJoin(condition=[true], joinType=[inner])
                     :- LogicalJoin(condition=[true], joinType=[inner])
                     :  :- LogicalJoin(condition=[true], joinType=[inner])
                     :  :  :- LogicalJoin(condition=[true], joinType=[inner])
                     :  :  :  :- LogicalJoin(condition=[true], joinType=[inner])
                     :  :  :  :  :- LogicalJoin(condition=[true], joinType=[inner])
                     :  :  :  :  :  :- LogicalJoin(condition=[true], joinType=[inner])
                     :  :  :  :  :  :  :- LogicalJoin(condition=[true], joinType=[inner])
                     :  :  :  :  :  :  :  :- LogicalJoin(condition=[true], joinType=[inner])
                     :  :  :  :  :  :  :  :  :- LogicalJoin(condition=[true], joinType=[inner])
                     :  :  :  :  :  :  :  :  :  :- LogicalJoin(condition=[true], joinType=[inner])
                     :  :  :  :  :  :  :  :  :  :  :- LogicalJoin(condition=[true], joinType=[inner])
                     :  :  :  :  :  :  :  :  :  :  :  :- LogicalJoin(condition=[true], joinType=[inner])
                     :  :  :  :  :  :  :  :  :  :  :  :  :- LogicalJoin(condition=[true], joinType=[inner])
                     :  :  :  :  :  :  :  :  :  :  :  :  :  :- LogicalJoin(condition=[true], joinType=[inner])
                     :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- LogicalJoin(condition=[true], joinType=[inner])
                     :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- LogicalJoin(condition=[true], joinType=[inner])
                     :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, store_sales]])
                     :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, store_returns]])
                     :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- LogicalFilter(condition=[>($1, *(2, $2))])
                     :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- LogicalAggregate(group=[{0}], sale=[SUM($1)], refund=[SUM($2)])
                     :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- LogicalProject(cs_item_sk=[$14], cs_ext_list_price=[$24], $f2=[+(+($56, $57), $58)])
                     :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- LogicalFilter(condition=[AND(=($14, $35), =($16, $49))])
                     :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- LogicalJoin(condition=[true], joinType=[inner])
                     :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 :- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, catalog_sales]])
                     :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, catalog_returns]])
                     :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, date_dim]])
                     :  :  :  :  :  :  :  :  :  :  :  :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, date_dim]])
                     :  :  :  :  :  :  :  :  :  :  :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, date_dim]])
                     :  :  :  :  :  :  :  :  :  :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, store]])
                     :  :  :  :  :  :  :  :  :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, customer]])
                     :  :  :  :  :  :  :  :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, customer_demographics]])
                     :  :  :  :  :  :  :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, customer_demographics]])
                     :  :  :  :  :  :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, promotion]])
                     :  :  :  :  :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, household_demographics]])
                     :  :  :  :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, household_demographics]])
                     :  :  :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, customer_address]])
                     :  :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, customer_address]])
                     :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, income_band]])
                     :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, income_band]])
                     +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, item]])
]]>
    </Resource>
    <Resource name="optimized exec plan">
      <![CDATA[
Sort(orderBy=[product_name ASC, store_name ASC, cnt0 ASC])
+- Exchange(distribution=[single])
   +- Calc(select=[product_name, store_name, store_zip, b_street_number, b_streen_name, b_city, b_zip, c_street_number, c_street_name, c_city, c_zip, CAST(2000 AS INTEGER) AS syear, cnt, s1, s2, s3, s10, s20, s30, CAST(2001 AS INTEGER) AS syear0, cnt0])
      +- HashJoin(joinType=[InnerJoin], where=[((item_sk = item_sk0) AND (cnt0 <= cnt) AND (store_name = store_name0) AND (store_zip = store_zip0))], select=[product_name, item_sk, store_name, store_zip, b_street_number, b_streen_name, b_city, b_zip, c_street_number, c_street_name, c_city, c_zip, cnt, s1, s2, s3, item_sk0, store_name0, store_zip0, cnt0, s10, s20, s30], build=[right])
         :- Exchange(distribution=[hash[item_sk, store_name, store_zip]])
         :  +- Calc(select=[product_name, item_sk, store_name, store_zip, b_street_number, b_streen_name, b_city, b_zip, c_street_number, c_street_name, c_city, c_zip, cnt, s1, s2, s3])
         :     +- HashAggregate(isMerge=[false], groupBy=[item_sk, store_name, store_zip, b_street_number, b_streen_name, b_city, b_zip, c_street_number, c_street_name, c_city, c_zip, syear, fsyear, s2year], auxGrouping=[product_name], select=[item_sk, store_name, store_zip, b_street_number, b_streen_name, b_city, b_zip, c_street_number, c_street_name, c_city, c_zip, syear, fsyear, s2year, product_name, COUNT(*) AS cnt, SUM(ss_wholesale_cost) AS s1, SUM(ss_list_price) AS s2, SUM(ss_coupon_amt) AS s3])
         :        +- Exchange(distribution=[hash[item_sk, store_name, store_zip, b_street_number, b_streen_name, b_city, b_zip, c_street_number, c_street_name, c_city, c_zip, syear, fsyear, s2year]])
         :           +- Calc(select=[i_product_name AS product_name, i_item_sk AS item_sk, s_store_name AS store_name, s_zip AS store_zip, ca_street_number0 AS b_street_number, ca_street_name0 AS b_streen_name, ca_city0 AS b_city, ca_zip0 AS b_zip, ca_street_number AS c_street_number, ca_street_name AS c_street_name, ca_city AS c_city, ca_zip AS c_zip, CAST(2000 AS INTEGER) AS syear, d_year0 AS fsyear, d_year1 AS s2year, ss_wholesale_cost, ss_list_price, ss_coupon_amt])
         :              +- HashJoin(joinType=[InnerJoin], where=[(ss_store_sk = s_store_sk)], select=[ca_street_number, ca_street_name, ca_city, ca_zip, ss_store_sk, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, ca_street_number0, ca_street_name0, ca_city0, ca_zip0, d_year0, d_year1, s_store_sk, s_store_name, s_zip], isBroadcast=[true], build=[right])
         :                 :- Calc(select=[ca_street_number, ca_street_name, ca_city, ca_zip, ss_store_sk, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, ca_street_number0, ca_street_name0, ca_city0, ca_zip0, d_year0, d_year AS d_year1])
         :                 :  +- HashJoin(joinType=[InnerJoin], where=[(c_first_shipto_date_sk = d_date_sk)], select=[c_first_shipto_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_store_sk, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, ca_street_number0, ca_street_name0, ca_city0, ca_zip0, d_year0, d_date_sk, d_year], isBroadcast=[true], build=[right])
         :                 :     :- Calc(select=[c_first_shipto_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_store_sk, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, ca_street_number0, ca_street_name0, ca_city0, ca_zip0, d_year AS d_year0])
         :                 :     :  +- HashJoin(joinType=[InnerJoin], where=[(c_first_sales_date_sk = d_date_sk)], select=[c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_store_sk, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, ca_street_number0, ca_street_name0, ca_city0, ca_zip0, d_date_sk, d_year], isBroadcast=[true], build=[right])
         :                 :     :     :- Calc(select=[c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_store_sk, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, ca_street_number0, ca_street_name0, ca_city0, ca_zip0])
         :                 :     :     :  +- HashJoin(joinType=[InnerJoin], where=[(c_current_hdemo_sk = hd_demo_sk)], select=[c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_store_sk, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, ca_street_number0, ca_street_name0, ca_city0, ca_zip0, hd_demo_sk], isBroadcast=[true], build=[right])
         :                 :     :     :     :- Calc(select=[c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_store_sk, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, ca_street_number0, ca_street_name0, ca_city0, ca_zip0])
         :                 :     :     :     :  +- HashJoin(joinType=[InnerJoin], where=[(ss_hdemo_sk = hd_demo_sk)], select=[c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_hdemo_sk, ss_store_sk, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, ca_street_number0, ca_street_name0, ca_city0, ca_zip0, hd_demo_sk], isBroadcast=[true], build=[right])
         :                 :     :     :     :     :- Calc(select=[c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_hdemo_sk, ss_store_sk, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, ca_street_number0, ca_street_name0, ca_city0, ca_zip0])
         :                 :     :     :     :     :  +- HashJoin(joinType=[InnerJoin], where=[(ss_promo_sk = p_promo_sk)], select=[c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_hdemo_sk, ss_store_sk, ss_promo_sk, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, ca_street_number0, ca_street_name0, ca_city0, ca_zip0, p_promo_sk], isBroadcast=[true], build=[right])
         :                 :     :     :     :     :     :- Calc(select=[c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_hdemo_sk, ss_store_sk, ss_promo_sk, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, ca_street_number0, ca_street_name0, ca_city0, ca_zip0])
         :                 :     :     :     :     :     :  +- HashJoin(joinType=[InnerJoin], where=[(sr_item_sk = cs_item_sk)], select=[sr_item_sk, c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_hdemo_sk, ss_store_sk, ss_promo_sk, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, ca_street_number0, ca_street_name0, ca_city0, ca_zip0, cs_item_sk], isBroadcast=[true], build=[right])
         :                 :     :     :     :     :     :     :- Calc(select=[sr_item_sk, c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_hdemo_sk, ss_store_sk, ss_promo_sk, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, ca_street_number0, ca_street_name0, ca_city0, ca_zip0])
         :                 :     :     :     :     :     :     :  +- HashJoin(joinType=[InnerJoin], where=[((sr_ticket_number = ss_ticket_number) AND (sr_item_sk = ss_item_sk))], select=[sr_item_sk, sr_ticket_number, c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_item_sk, ss_hdemo_sk, ss_store_sk, ss_promo_sk, ss_ticket_number, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, ca_street_number0, ca_street_name0, ca_city0, ca_zip0], build=[right])
         :                 :     :     :     :     :     :     :     :- Exchange(distribution=[hash[sr_item_sk]])
         :                 :     :     :     :     :     :     :     :  +- TableSourceScan(table=[[hive, tpcds_bin_partitioned_orc_10000, store_returns, project=[sr_item_sk, sr_ticket_number]]], fields=[sr_item_sk, sr_ticket_number])(reuse_id=[5])
         :                 :     :     :     :     :     :     :     +- Exchange(distribution=[hash[ss_item_sk]])
         :                 :     :     :     :     :     :     :        +- Calc(select=[c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_item_sk, ss_hdemo_sk, ss_store_sk, ss_promo_sk, ss_ticket_number, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, ca_street_number0, ca_street_name0, ca_city0, ca_zip0])
         :                 :     :     :     :     :     :     :           +- HashJoin(joinType=[InnerJoin], where=[(ss_addr_sk = ca_address_sk)], select=[c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_item_sk, ss_hdemo_sk, ss_addr_sk, ss_store_sk, ss_promo_sk, ss_ticket_number, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, ca_address_sk, ca_street_number0, ca_street_name0, ca_city0, ca_zip0], build=[right])
         :                 :     :     :     :     :     :     :              :- Exchange(distribution=[hash[ss_addr_sk]])
         :                 :     :     :     :     :     :     :              :  +- Calc(select=[c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_item_sk, ss_hdemo_sk, ss_addr_sk, ss_store_sk, ss_promo_sk, ss_ticket_number, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name])
         :                 :     :     :     :     :     :     :              :     +- HashJoin(joinType=[InnerJoin], where=[((c_current_cdemo_sk = cd_demo_sk) AND (cd_marital_status <> cd_marital_status0))], select=[c_current_cdemo_sk, c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_item_sk, ss_hdemo_sk, ss_addr_sk, ss_store_sk, ss_promo_sk, ss_ticket_number, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, cd_marital_status, cd_demo_sk, cd_marital_status0], build=[right])
         :                 :     :     :     :     :     :     :              :        :- Exchange(distribution=[hash[c_current_cdemo_sk]])
         :                 :     :     :     :     :     :     :              :        :  +- Calc(select=[c_current_cdemo_sk, c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_item_sk, ss_hdemo_sk, ss_addr_sk, ss_store_sk, ss_promo_sk, ss_ticket_number, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, cd_marital_status])
         :                 :     :     :     :     :     :     :              :        :     +- HashJoin(joinType=[InnerJoin], where=[(ss_cdemo_sk = cd_demo_sk)], select=[c_current_cdemo_sk, c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_item_sk, ss_cdemo_sk, ss_hdemo_sk, ss_addr_sk, ss_store_sk, ss_promo_sk, ss_ticket_number, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, cd_demo_sk, cd_marital_status], build=[right])
         :                 :     :     :     :     :     :     :              :        :        :- Exchange(distribution=[hash[ss_cdemo_sk]])
         :                 :     :     :     :     :     :     :              :        :        :  +- Calc(select=[c_current_cdemo_sk, c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_item_sk, ss_cdemo_sk, ss_hdemo_sk, ss_addr_sk, ss_store_sk, ss_promo_sk, ss_ticket_number, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name])
         :                 :     :     :     :     :     :     :              :        :        :     +- HashJoin(joinType=[InnerJoin], where=[(ss_customer_sk = c_customer_sk)], select=[c_customer_sk, c_current_cdemo_sk, c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_item_sk, ss_customer_sk, ss_cdemo_sk, ss_hdemo_sk, ss_addr_sk, ss_store_sk, ss_promo_sk, ss_ticket_number, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name], build=[right])
         :                 :     :     :     :     :     :     :              :        :        :        :- Exchange(distribution=[hash[c_customer_sk]])(reuse_id=[6])
         :                 :     :     :     :     :     :     :              :        :        :        :  +- Calc(select=[c_customer_sk, c_current_cdemo_sk, c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip])
         :                 :     :     :     :     :     :     :              :        :        :        :     +- HashJoin(joinType=[InnerJoin], where=[(c_current_addr_sk = ca_address_sk)], select=[c_customer_sk, c_current_cdemo_sk, c_current_hdemo_sk, c_current_addr_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_address_sk, ca_street_number, ca_street_name, ca_city, ca_zip], build=[right])
         :                 :     :     :     :     :     :     :              :        :        :        :        :- Exchange(distribution=[hash[c_current_addr_sk]])
         :                 :     :     :     :     :     :     :              :        :        :        :        :  +- Calc(select=[c_customer_sk, c_current_cdemo_sk, c_current_hdemo_sk, c_current_addr_sk, c_first_shipto_date_sk, c_first_sales_date_sk], where=[(c_first_sales_date_sk IS NOT NULL AND c_first_shipto_date_sk IS NOT NULL)])
         :                 :     :     :     :     :     :     :              :        :        :        :        :     +- TableSourceScan(table=[[hive, tpcds_bin_partitioned_orc_10000, customer, project=[c_customer_sk, c_current_cdemo_sk, c_current_hdemo_sk, c_current_addr_sk, c_first_shipto_date_sk, c_first_sales_date_sk]]], fields=[c_customer_sk, c_current_cdemo_sk, c_current_hdemo_sk, c_current_addr_sk, c_first_shipto_date_sk, c_first_sales_date_sk])
         :                 :     :     :     :     :     :     :              :        :        :        :        +- Exchange(distribution=[hash[ca_address_sk]])
         :                 :     :     :     :     :     :     :              :        :        :        :           +- TableSourceScan(table=[[hive, tpcds_bin_partitioned_orc_10000, customer_address, project=[ca_address_sk, ca_street_number, ca_street_name, ca_city, ca_zip]]], fields=[ca_address_sk, ca_street_number, ca_street_name, ca_city, ca_zip])(reuse_id=[2])
         :                 :     :     :     :     :     :     :              :        :        :        +- Exchange(distribution=[hash[ss_customer_sk]])
         :                 :     :     :     :     :     :     :              :        :        :           +- Calc(select=[ss_item_sk, ss_customer_sk, ss_cdemo_sk, ss_hdemo_sk, ss_addr_sk, ss_store_sk, ss_promo_sk, ss_ticket_number, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name])
         :                 :     :     :     :     :     :     :              :        :        :              +- HashJoin(joinType=[InnerJoin], where=[(ss_sold_date_sk = d_date_sk)], select=[ss_item_sk, ss_customer_sk, ss_cdemo_sk, ss_hdemo_sk, ss_addr_sk, ss_store_sk, ss_promo_sk, ss_ticket_number, ss_wholesale_cost, ss_list_price, ss_coupon_amt, ss_sold_date_sk, i_item_sk, i_product_name, d_date_sk], isBroadcast=[true], build=[right])
         :                 :     :     :     :     :     :     :              :        :        :                 :- HashJoin(joinType=[InnerJoin], where=[(ss_item_sk = i_item_sk)], select=[ss_item_sk, ss_customer_sk, ss_cdemo_sk, ss_hdemo_sk, ss_addr_sk, ss_store_sk, ss_promo_sk, ss_ticket_number, ss_wholesale_cost, ss_list_price, ss_coupon_amt, ss_sold_date_sk, i_item_sk, i_product_name], isBroadcast=[true], build=[right])(reuse_id=[7])
         :                 :     :     :     :     :     :     :              :        :        :                 :  :- TableSourceScan(table=[[hive, tpcds_bin_partitioned_orc_10000, store_sales, project=[ss_item_sk, ss_customer_sk, ss_cdemo_sk, ss_hdemo_sk, ss_addr_sk, ss_store_sk, ss_promo_sk, ss_ticket_number, ss_wholesale_cost, ss_list_price, ss_coupon_amt, ss_sold_date_sk]]], fields=[ss_item_sk, ss_customer_sk, ss_cdemo_sk, ss_hdemo_sk, ss_addr_sk, ss_store_sk, ss_promo_sk, ss_ticket_number, ss_wholesale_cost, ss_list_price, ss_coupon_amt, ss_sold_date_sk])
         :                 :     :     :     :     :     :     :              :        :        :                 :  +- Exchange(distribution=[broadcast])
         :                 :     :     :     :     :     :     :              :        :        :                 :     +- Calc(select=[i_item_sk, i_product_name], where=[(SEARCH(i_color, Sarg[_UTF-16LE'burnished', _UTF-16LE'chocolate', _UTF-16LE'dim', _UTF-16LE'maroon', _UTF-16LE'navajo', _UTF-16LE'steel']) AND SEARCH(i_current_price, Sarg[[36..45]]) AND i_current_price IS NOT NULL)])
         :                 :     :     :     :     :     :     :              :        :        :                 :        +- TableSourceScan(table=[[hive, tpcds_bin_partitioned_orc_10000, item, project=[i_item_sk, i_current_price, i_color, i_product_name]]], fields=[i_item_sk, i_current_price, i_color, i_product_name])
         :                 :     :     :     :     :     :     :              :        :        :                 +- Exchange(distribution=[broadcast])
         :                 :     :     :     :     :     :     :              :        :        :                    +- Calc(select=[d_date_sk], where=[(d_year = 2000)])
         :                 :     :     :     :     :     :     :              :        :        :                       +- TableSourceScan(table=[[hive, tpcds_bin_partitioned_orc_10000, date_dim, project=[d_date_sk, d_year]]], fields=[d_date_sk, d_year])(reuse_id=[4])
         :                 :     :     :     :     :     :     :              :        :        +- Exchange(distribution=[hash[cd_demo_sk]])
         :                 :     :     :     :     :     :     :              :        :           +- TableSourceScan(table=[[hive, tpcds_bin_partitioned_orc_10000, customer_demographics, project=[cd_demo_sk, cd_marital_status]]], fields=[cd_demo_sk, cd_marital_status])(reuse_id=[1])
         :                 :     :     :     :     :     :     :              :        +- Exchange(distribution=[hash[cd_demo_sk]])
         :                 :     :     :     :     :     :     :              :           +- Reused(reference_id=[1])
         :                 :     :     :     :     :     :     :              +- Exchange(distribution=[hash[ca_address_sk]])
         :                 :     :     :     :     :     :     :                 +- Reused(reference_id=[2])
         :                 :     :     :     :     :     :     +- Exchange(distribution=[broadcast])(reuse_id=[8])
         :                 :     :     :     :     :     :        +- Calc(select=[cs_item_sk], where=[(sale > (2 * refund))])
         :                 :     :     :     :     :     :           +- HashAggregate(isMerge=[false], groupBy=[cs_item_sk], select=[cs_item_sk, SUM(cs_ext_list_price) AS sale, SUM($f2) AS refund])
         :                 :     :     :     :     :     :              +- Calc(select=[cs_item_sk, cs_ext_list_price, ((cr_refunded_cash + cr_reversed_charge) + cr_store_credit) AS $f2])
         :                 :     :     :     :     :     :                 +- HashJoin(joinType=[InnerJoin], where=[((cs_item_sk = cr_item_sk) AND (cs_order_number = cr_order_number))], select=[cs_item_sk, cs_order_number, cs_ext_list_price, cr_item_sk, cr_order_number, cr_refunded_cash, cr_reversed_charge, cr_store_credit], build=[right])
         :                 :     :     :     :     :     :                    :- Exchange(distribution=[hash[cs_item_sk]])
         :                 :     :     :     :     :     :                    :  +- TableSourceScan(table=[[hive, tpcds_bin_partitioned_orc_10000, catalog_sales, project=[cs_item_sk, cs_order_number, cs_ext_list_price]]], fields=[cs_item_sk, cs_order_number, cs_ext_list_price])
         :                 :     :     :     :     :     :                    +- Exchange(distribution=[hash[cr_item_sk]])
         :                 :     :     :     :     :     :                       +- TableSourceScan(table=[[hive, tpcds_bin_partitioned_orc_10000, catalog_returns, project=[cr_item_sk, cr_order_number, cr_refunded_cash, cr_reversed_charge, cr_store_credit]]], fields=[cr_item_sk, cr_order_number, cr_refunded_cash, cr_reversed_charge, cr_store_credit])
         :                 :     :     :     :     :     +- Exchange(distribution=[broadcast])
         :                 :     :     :     :     :        +- TableSourceScan(table=[[hive, tpcds_bin_partitioned_orc_10000, promotion, project=[p_promo_sk]]], fields=[p_promo_sk])(reuse_id=[9])
         :                 :     :     :     :     +- Exchange(distribution=[broadcast])(reuse_id=[3])
         :                 :     :     :     :        +- Calc(select=[hd_demo_sk])
         :                 :     :     :     :           +- HashJoin(joinType=[InnerJoin], where=[(hd_income_band_sk = ib_income_band_sk)], select=[hd_demo_sk, hd_income_band_sk, ib_income_band_sk], isBroadcast=[true], build=[right])
         :                 :     :     :     :              :- TableSourceScan(table=[[hive, tpcds_bin_partitioned_orc_10000, household_demographics, project=[hd_demo_sk, hd_income_band_sk]]], fields=[hd_demo_sk, hd_income_band_sk])
         :                 :     :     :     :              +- Exchange(distribution=[broadcast])
         :                 :     :     :     :                 +- TableSourceScan(table=[[hive, tpcds_bin_partitioned_orc_10000, income_band, project=[ib_income_band_sk]]], fields=[ib_income_band_sk])
         :                 :     :     :     +- Reused(reference_id=[3])
         :                 :     :     +- Exchange(distribution=[broadcast])
         :                 :     :        +- Reused(reference_id=[4])
         :                 :     +- Exchange(distribution=[broadcast])
         :                 :        +- Reused(reference_id=[4])
         :                 +- Exchange(distribution=[broadcast])
         :                    +- TableSourceScan(table=[[hive, tpcds_bin_partitioned_orc_10000, store, project=[s_store_sk, s_store_name, s_zip]]], fields=[s_store_sk, s_store_name, s_zip])(reuse_id=[10])
         +- Exchange(distribution=[hash[item_sk, store_name, store_zip]])
            +- Calc(select=[item_sk, store_name, store_zip, cnt, s1, s2, s3])
               +- HashAggregate(isMerge=[false], groupBy=[item_sk, store_name, store_zip, b_street_number, b_streen_name, b_city, b_zip, c_street_number, c_street_name, c_city, c_zip, syear, fsyear, s2year], select=[item_sk, store_name, store_zip, b_street_number, b_streen_name, b_city, b_zip, c_street_number, c_street_name, c_city, c_zip, syear, fsyear, s2year, COUNT(*) AS cnt, SUM(ss_wholesale_cost) AS s1, SUM(ss_list_price) AS s2, SUM(ss_coupon_amt) AS s3])
                  +- Exchange(distribution=[hash[item_sk, store_name, store_zip, b_street_number, b_streen_name, b_city, b_zip, c_street_number, c_street_name, c_city, c_zip, syear, fsyear, s2year]])
                     +- Calc(select=[i_product_name AS product_name, i_item_sk AS item_sk, s_store_name AS store_name, s_zip AS store_zip, ca_street_number0 AS b_street_number, ca_street_name0 AS b_streen_name, ca_city0 AS b_city, ca_zip0 AS b_zip, ca_street_number AS c_street_number, ca_street_name AS c_street_name, ca_city AS c_city, ca_zip AS c_zip, CAST(2001 AS INTEGER) AS syear, d_year0 AS fsyear, d_year1 AS s2year, ss_wholesale_cost, ss_list_price, ss_coupon_amt])
                        +- HashJoin(joinType=[InnerJoin], where=[(ss_store_sk = s_store_sk)], select=[ca_street_number, ca_street_name, ca_city, ca_zip, ss_store_sk, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, ca_street_number0, ca_street_name0, ca_city0, ca_zip0, d_year0, d_year1, s_store_sk, s_store_name, s_zip], isBroadcast=[true], build=[right])
                           :- Calc(select=[ca_street_number, ca_street_name, ca_city, ca_zip, ss_store_sk, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, ca_street_number0, ca_street_name0, ca_city0, ca_zip0, d_year0, d_year AS d_year1])
                           :  +- HashJoin(joinType=[InnerJoin], where=[(c_first_shipto_date_sk = d_date_sk)], select=[c_first_shipto_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_store_sk, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, ca_street_number0, ca_street_name0, ca_city0, ca_zip0, d_year0, d_date_sk, d_year], isBroadcast=[true], build=[right])
                           :     :- Calc(select=[c_first_shipto_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_store_sk, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, ca_street_number0, ca_street_name0, ca_city0, ca_zip0, d_year AS d_year0])
                           :     :  +- HashJoin(joinType=[InnerJoin], where=[(c_first_sales_date_sk = d_date_sk)], select=[c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_store_sk, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, ca_street_number0, ca_street_name0, ca_city0, ca_zip0, d_date_sk, d_year], isBroadcast=[true], build=[right])
                           :     :     :- Calc(select=[c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_store_sk, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, ca_street_number0, ca_street_name0, ca_city0, ca_zip0])
                           :     :     :  +- HashJoin(joinType=[InnerJoin], where=[(c_current_hdemo_sk = hd_demo_sk)], select=[c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_store_sk, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, ca_street_number0, ca_street_name0, ca_city0, ca_zip0, hd_demo_sk], isBroadcast=[true], build=[right])
                           :     :     :     :- Calc(select=[c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_store_sk, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, ca_street_number0, ca_street_name0, ca_city0, ca_zip0])
                           :     :     :     :  +- HashJoin(joinType=[InnerJoin], where=[(ss_hdemo_sk = hd_demo_sk)], select=[c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_hdemo_sk, ss_store_sk, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, ca_street_number0, ca_street_name0, ca_city0, ca_zip0, hd_demo_sk], isBroadcast=[true], build=[right])
                           :     :     :     :     :- Calc(select=[c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_hdemo_sk, ss_store_sk, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, ca_street_number0, ca_street_name0, ca_city0, ca_zip0])
                           :     :     :     :     :  +- HashJoin(joinType=[InnerJoin], where=[(ss_promo_sk = p_promo_sk)], select=[c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_hdemo_sk, ss_store_sk, ss_promo_sk, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, ca_street_number0, ca_street_name0, ca_city0, ca_zip0, p_promo_sk], isBroadcast=[true], build=[right])
                           :     :     :     :     :     :- Calc(select=[c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_hdemo_sk, ss_store_sk, ss_promo_sk, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, ca_street_number0, ca_street_name0, ca_city0, ca_zip0])
                           :     :     :     :     :     :  +- HashJoin(joinType=[InnerJoin], where=[(sr_item_sk = cs_item_sk)], select=[sr_item_sk, c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_hdemo_sk, ss_store_sk, ss_promo_sk, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, ca_street_number0, ca_street_name0, ca_city0, ca_zip0, cs_item_sk], isBroadcast=[true], build=[right])
                           :     :     :     :     :     :     :- Calc(select=[sr_item_sk, c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_hdemo_sk, ss_store_sk, ss_promo_sk, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, ca_street_number0, ca_street_name0, ca_city0, ca_zip0])
                           :     :     :     :     :     :     :  +- HashJoin(joinType=[InnerJoin], where=[((sr_ticket_number = ss_ticket_number) AND (sr_item_sk = ss_item_sk))], select=[sr_item_sk, sr_ticket_number, c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_item_sk, ss_hdemo_sk, ss_store_sk, ss_promo_sk, ss_ticket_number, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, ca_street_number0, ca_street_name0, ca_city0, ca_zip0], build=[right])
                           :     :     :     :     :     :     :     :- Exchange(distribution=[hash[sr_item_sk]])
                           :     :     :     :     :     :     :     :  +- Reused(reference_id=[5])
                           :     :     :     :     :     :     :     +- Exchange(distribution=[hash[ss_item_sk]])
                           :     :     :     :     :     :     :        +- Calc(select=[c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_item_sk, ss_hdemo_sk, ss_store_sk, ss_promo_sk, ss_ticket_number, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, ca_street_number0, ca_street_name0, ca_city0, ca_zip0])
                           :     :     :     :     :     :     :           +- HashJoin(joinType=[InnerJoin], where=[(ss_addr_sk = ca_address_sk)], select=[c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_item_sk, ss_hdemo_sk, ss_addr_sk, ss_store_sk, ss_promo_sk, ss_ticket_number, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, ca_address_sk, ca_street_number0, ca_street_name0, ca_city0, ca_zip0], build=[right])
                           :     :     :     :     :     :     :              :- Exchange(distribution=[hash[ss_addr_sk]])
                           :     :     :     :     :     :     :              :  +- Calc(select=[c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_item_sk, ss_hdemo_sk, ss_addr_sk, ss_store_sk, ss_promo_sk, ss_ticket_number, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name])
                           :     :     :     :     :     :     :              :     +- HashJoin(joinType=[InnerJoin], where=[((c_current_cdemo_sk = cd_demo_sk) AND (cd_marital_status <> cd_marital_status0))], select=[c_current_cdemo_sk, c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_item_sk, ss_hdemo_sk, ss_addr_sk, ss_store_sk, ss_promo_sk, ss_ticket_number, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, cd_marital_status, cd_demo_sk, cd_marital_status0], build=[right])
                           :     :     :     :     :     :     :              :        :- Exchange(distribution=[hash[c_current_cdemo_sk]])
                           :     :     :     :     :     :     :              :        :  +- Calc(select=[c_current_cdemo_sk, c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_item_sk, ss_hdemo_sk, ss_addr_sk, ss_store_sk, ss_promo_sk, ss_ticket_number, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, cd_marital_status])
                           :     :     :     :     :     :     :              :        :     +- HashJoin(joinType=[InnerJoin], where=[(ss_cdemo_sk = cd_demo_sk)], select=[c_current_cdemo_sk, c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_item_sk, ss_cdemo_sk, ss_hdemo_sk, ss_addr_sk, ss_store_sk, ss_promo_sk, ss_ticket_number, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name, cd_demo_sk, cd_marital_status], build=[right])
                           :     :     :     :     :     :     :              :        :        :- Exchange(distribution=[hash[ss_cdemo_sk]])
                           :     :     :     :     :     :     :              :        :        :  +- Calc(select=[c_current_cdemo_sk, c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_item_sk, ss_cdemo_sk, ss_hdemo_sk, ss_addr_sk, ss_store_sk, ss_promo_sk, ss_ticket_number, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name])
                           :     :     :     :     :     :     :              :        :        :     +- HashJoin(joinType=[InnerJoin], where=[(ss_customer_sk = c_customer_sk)], select=[c_customer_sk, c_current_cdemo_sk, c_current_hdemo_sk, c_first_shipto_date_sk, c_first_sales_date_sk, ca_street_number, ca_street_name, ca_city, ca_zip, ss_item_sk, ss_customer_sk, ss_cdemo_sk, ss_hdemo_sk, ss_addr_sk, ss_store_sk, ss_promo_sk, ss_ticket_number, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name], build=[right])
                           :     :     :     :     :     :     :              :        :        :        :- Reused(reference_id=[6])
                           :     :     :     :     :     :     :              :        :        :        +- Exchange(distribution=[hash[ss_customer_sk]])
                           :     :     :     :     :     :     :              :        :        :           +- Calc(select=[ss_item_sk, ss_customer_sk, ss_cdemo_sk, ss_hdemo_sk, ss_addr_sk, ss_store_sk, ss_promo_sk, ss_ticket_number, ss_wholesale_cost, ss_list_price, ss_coupon_amt, i_item_sk, i_product_name])
                           :     :     :     :     :     :     :              :        :        :              +- HashJoin(joinType=[InnerJoin], where=[(ss_sold_date_sk = d_date_sk)], select=[ss_item_sk, ss_customer_sk, ss_cdemo_sk, ss_hdemo_sk, ss_addr_sk, ss_store_sk, ss_promo_sk, ss_ticket_number, ss_wholesale_cost, ss_list_price, ss_coupon_amt, ss_sold_date_sk, i_item_sk, i_product_name, d_date_sk], isBroadcast=[true], build=[right])
                           :     :     :     :     :     :     :              :        :        :                 :- Reused(reference_id=[7])
                           :     :     :     :     :     :     :              :        :        :                 +- Exchange(distribution=[broadcast])
                           :     :     :     :     :     :     :              :        :        :                    +- Calc(select=[d_date_sk], where=[(d_year = 2001)])
                           :     :     :     :     :     :     :              :        :        :                       +- Reused(reference_id=[4])
                           :     :     :     :     :     :     :              :        :        +- Exchange(distribution=[hash[cd_demo_sk]])
                           :     :     :     :     :     :     :              :        :           +- Reused(reference_id=[1])
                           :     :     :     :     :     :     :              :        +- Exchange(distribution=[hash[cd_demo_sk]])
                           :     :     :     :     :     :     :              :           +- Reused(reference_id=[1])
                           :     :     :     :     :     :     :              +- Exchange(distribution=[hash[ca_address_sk]])
                           :     :     :     :     :     :     :                 +- Reused(reference_id=[2])
                           :     :     :     :     :     :     +- Reused(reference_id=[8])
                           :     :     :     :     :     +- Exchange(distribution=[broadcast])
                           :     :     :     :     :        +- Reused(reference_id=[9])
                           :     :     :     :     +- Reused(reference_id=[3])
                           :     :     :     +- Reused(reference_id=[3])
                           :     :     +- Exchange(distribution=[broadcast])
                           :     :        +- Reused(reference_id=[4])
                           :     +- Exchange(distribution=[broadcast])
                           :        +- Reused(reference_id=[4])
                           +- Exchange(distribution=[broadcast])
                              +- Reused(reference_id=[10])
]]>
    </Resource>
  </TestCase>
