  <TestCase name="getExecPlan[q88]">
    <Resource name="sql">
      <![CDATA[/*
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

-- start query 1 in stream 0 using template query88.tpl and seed 318176889
select  *
from
 (select count(*) h8_30_to_9
 from store_sales, household_demographics , time_dim, store
 where ss_sold_time_sk = time_dim.t_time_sk   
     and ss_hdemo_sk = household_demographics.hd_demo_sk 
     and ss_store_sk = s_store_sk
     and time_dim.t_hour = 8
     and time_dim.t_minute >= 30
     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2)) 
     and store.s_store_name = 'ese') s1,
 (select count(*) h9_to_9_30 
 from store_sales, household_demographics , time_dim, store
 where ss_sold_time_sk = time_dim.t_time_sk
     and ss_hdemo_sk = household_demographics.hd_demo_sk
     and ss_store_sk = s_store_sk 
     and time_dim.t_hour = 9 
     and time_dim.t_minute < 30
     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
     and store.s_store_name = 'ese') s2,
 (select count(*) h9_30_to_10 
 from store_sales, household_demographics , time_dim, store
 where ss_sold_time_sk = time_dim.t_time_sk
     and ss_hdemo_sk = household_demographics.hd_demo_sk
     and ss_store_sk = s_store_sk
     and time_dim.t_hour = 9
     and time_dim.t_minute >= 30
     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
     and store.s_store_name = 'ese') s3,
 (select count(*) h10_to_10_30
 from store_sales, household_demographics , time_dim, store
 where ss_sold_time_sk = time_dim.t_time_sk
     and ss_hdemo_sk = household_demographics.hd_demo_sk
     and ss_store_sk = s_store_sk
     and time_dim.t_hour = 10 
     and time_dim.t_minute < 30
     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
     and store.s_store_name = 'ese') s4,
 (select count(*) h10_30_to_11
 from store_sales, household_demographics , time_dim, store
 where ss_sold_time_sk = time_dim.t_time_sk
     and ss_hdemo_sk = household_demographics.hd_demo_sk
     and ss_store_sk = s_store_sk
     and time_dim.t_hour = 10 
     and time_dim.t_minute >= 30
     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
     and store.s_store_name = 'ese') s5,
 (select count(*) h11_to_11_30
 from store_sales, household_demographics , time_dim, store
 where ss_sold_time_sk = time_dim.t_time_sk
     and ss_hdemo_sk = household_demographics.hd_demo_sk
     and ss_store_sk = s_store_sk 
     and time_dim.t_hour = 11
     and time_dim.t_minute < 30
     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
     and store.s_store_name = 'ese') s6,
 (select count(*) h11_30_to_12
 from store_sales, household_demographics , time_dim, store
 where ss_sold_time_sk = time_dim.t_time_sk
     and ss_hdemo_sk = household_demographics.hd_demo_sk
     and ss_store_sk = s_store_sk
     and time_dim.t_hour = 11
     and time_dim.t_minute >= 30
     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
     and store.s_store_name = 'ese') s7,
 (select count(*) h12_to_12_30
 from store_sales, household_demographics , time_dim, store
 where ss_sold_time_sk = time_dim.t_time_sk
     and ss_hdemo_sk = household_demographics.hd_demo_sk
     and ss_store_sk = s_store_sk
     and time_dim.t_hour = 12
     and time_dim.t_minute < 30
     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
     and store.s_store_name = 'ese') s8


-- end query 1 in stream 0 using template query88.tpl
]]>
    </Resource>
    <Resource name="ast">
      <![CDATA[
LogicalProject(h8_30_to_9=[$0], h9_to_9_30=[$1], h9_30_to_10=[$2], h10_to_10_30=[$3], h10_30_to_11=[$4], h11_to_11_30=[$5], h11_30_to_12=[$6], h12_to_12_30=[$7])
+- LogicalJoin(condition=[true], joinType=[inner])
   :- LogicalJoin(condition=[true], joinType=[inner])
   :  :- LogicalJoin(condition=[true], joinType=[inner])
   :  :  :- LogicalJoin(condition=[true], joinType=[inner])
   :  :  :  :- LogicalJoin(condition=[true], joinType=[inner])
   :  :  :  :  :- LogicalJoin(condition=[true], joinType=[inner])
   :  :  :  :  :  :- LogicalJoin(condition=[true], joinType=[inner])
   :  :  :  :  :  :  :- LogicalAggregate(group=[{}], h8_30_to_9=[COUNT()])
   :  :  :  :  :  :  :  +- LogicalProject($f0=[0])
   :  :  :  :  :  :  :     +- LogicalFilter(condition=[AND(=($0, $28), =($4, $23), =($6, $38), =($31, 8), >=($32, 30), OR(AND(=($26, 3), <=($27, +(3, 2))), AND(=($26, 0), <=($27, +(0, 2))), AND(=($26, 1), <=($27, +(1, 2)))), =($43, _UTF-16LE'ese'))])
   :  :  :  :  :  :  :        +- LogicalJoin(condition=[true], joinType=[inner])
   :  :  :  :  :  :  :           :- LogicalJoin(condition=[true], joinType=[inner])
   :  :  :  :  :  :  :           :  :- LogicalJoin(condition=[true], joinType=[inner])
   :  :  :  :  :  :  :           :  :  :- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, store_sales]])
   :  :  :  :  :  :  :           :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, household_demographics]])
   :  :  :  :  :  :  :           :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, time_dim]])
   :  :  :  :  :  :  :           +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, store]])
   :  :  :  :  :  :  +- LogicalAggregate(group=[{}], h9_to_9_30=[COUNT()])
   :  :  :  :  :  :     +- LogicalProject($f0=[0])
   :  :  :  :  :  :        +- LogicalFilter(condition=[AND(=($0, $28), =($4, $23), =($6, $38), =($31, 9), <($32, 30), OR(AND(=($26, 3), <=($27, +(3, 2))), AND(=($26, 0), <=($27, +(0, 2))), AND(=($26, 1), <=($27, +(1, 2)))), =($43, _UTF-16LE'ese'))])
   :  :  :  :  :  :           +- LogicalJoin(condition=[true], joinType=[inner])
   :  :  :  :  :  :              :- LogicalJoin(condition=[true], joinType=[inner])
   :  :  :  :  :  :              :  :- LogicalJoin(condition=[true], joinType=[inner])
   :  :  :  :  :  :              :  :  :- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, store_sales]])
   :  :  :  :  :  :              :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, household_demographics]])
   :  :  :  :  :  :              :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, time_dim]])
   :  :  :  :  :  :              +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, store]])
   :  :  :  :  :  +- LogicalAggregate(group=[{}], h9_30_to_10=[COUNT()])
   :  :  :  :  :     +- LogicalProject($f0=[0])
   :  :  :  :  :        +- LogicalFilter(condition=[AND(=($0, $28), =($4, $23), =($6, $38), =($31, 9), >=($32, 30), OR(AND(=($26, 3), <=($27, +(3, 2))), AND(=($26, 0), <=($27, +(0, 2))), AND(=($26, 1), <=($27, +(1, 2)))), =($43, _UTF-16LE'ese'))])
   :  :  :  :  :           +- LogicalJoin(condition=[true], joinType=[inner])
   :  :  :  :  :              :- LogicalJoin(condition=[true], joinType=[inner])
   :  :  :  :  :              :  :- LogicalJoin(condition=[true], joinType=[inner])
   :  :  :  :  :              :  :  :- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, store_sales]])
   :  :  :  :  :              :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, household_demographics]])
   :  :  :  :  :              :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, time_dim]])
   :  :  :  :  :              +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, store]])
   :  :  :  :  +- LogicalAggregate(group=[{}], h10_to_10_30=[COUNT()])
   :  :  :  :     +- LogicalProject($f0=[0])
   :  :  :  :        +- LogicalFilter(condition=[AND(=($0, $28), =($4, $23), =($6, $38), =($31, 10), <($32, 30), OR(AND(=($26, 3), <=($27, +(3, 2))), AND(=($26, 0), <=($27, +(0, 2))), AND(=($26, 1), <=($27, +(1, 2)))), =($43, _UTF-16LE'ese'))])
   :  :  :  :           +- LogicalJoin(condition=[true], joinType=[inner])
   :  :  :  :              :- LogicalJoin(condition=[true], joinType=[inner])
   :  :  :  :              :  :- LogicalJoin(condition=[true], joinType=[inner])
   :  :  :  :              :  :  :- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, store_sales]])
   :  :  :  :              :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, household_demographics]])
   :  :  :  :              :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, time_dim]])
   :  :  :  :              +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, store]])
   :  :  :  +- LogicalAggregate(group=[{}], h10_30_to_11=[COUNT()])
   :  :  :     +- LogicalProject($f0=[0])
   :  :  :        +- LogicalFilter(condition=[AND(=($0, $28), =($4, $23), =($6, $38), =($31, 10), >=($32, 30), OR(AND(=($26, 3), <=($27, +(3, 2))), AND(=($26, 0), <=($27, +(0, 2))), AND(=($26, 1), <=($27, +(1, 2)))), =($43, _UTF-16LE'ese'))])
   :  :  :           +- LogicalJoin(condition=[true], joinType=[inner])
   :  :  :              :- LogicalJoin(condition=[true], joinType=[inner])
   :  :  :              :  :- LogicalJoin(condition=[true], joinType=[inner])
   :  :  :              :  :  :- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, store_sales]])
   :  :  :              :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, household_demographics]])
   :  :  :              :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, time_dim]])
   :  :  :              +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, store]])
   :  :  +- LogicalAggregate(group=[{}], h11_to_11_30=[COUNT()])
   :  :     +- LogicalProject($f0=[0])
   :  :        +- LogicalFilter(condition=[AND(=($0, $28), =($4, $23), =($6, $38), =($31, 11), <($32, 30), OR(AND(=($26, 3), <=($27, +(3, 2))), AND(=($26, 0), <=($27, +(0, 2))), AND(=($26, 1), <=($27, +(1, 2)))), =($43, _UTF-16LE'ese'))])
   :  :           +- LogicalJoin(condition=[true], joinType=[inner])
   :  :              :- LogicalJoin(condition=[true], joinType=[inner])
   :  :              :  :- LogicalJoin(condition=[true], joinType=[inner])
   :  :              :  :  :- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, store_sales]])
   :  :              :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, household_demographics]])
   :  :              :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, time_dim]])
   :  :              +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, store]])
   :  +- LogicalAggregate(group=[{}], h11_30_to_12=[COUNT()])
   :     +- LogicalProject($f0=[0])
   :        +- LogicalFilter(condition=[AND(=($0, $28), =($4, $23), =($6, $38), =($31, 11), >=($32, 30), OR(AND(=($26, 3), <=($27, +(3, 2))), AND(=($26, 0), <=($27, +(0, 2))), AND(=($26, 1), <=($27, +(1, 2)))), =($43, _UTF-16LE'ese'))])
   :           +- LogicalJoin(condition=[true], joinType=[inner])
   :              :- LogicalJoin(condition=[true], joinType=[inner])
   :              :  :- LogicalJoin(condition=[true], joinType=[inner])
   :              :  :  :- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, store_sales]])
   :              :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, household_demographics]])
   :              :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, time_dim]])
   :              +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, store]])
   +- LogicalAggregate(group=[{}], h12_to_12_30=[COUNT()])
      +- LogicalProject($f0=[0])
         +- LogicalFilter(condition=[AND(=($0, $28), =($4, $23), =($6, $38), =($31, 12), <($32, 30), OR(AND(=($26, 3), <=($27, +(3, 2))), AND(=($26, 0), <=($27, +(0, 2))), AND(=($26, 1), <=($27, +(1, 2)))), =($43, _UTF-16LE'ese'))])
            +- LogicalJoin(condition=[true], joinType=[inner])
               :- LogicalJoin(condition=[true], joinType=[inner])
               :  :- LogicalJoin(condition=[true], joinType=[inner])
               :  :  :- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, store_sales]])
               :  :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, household_demographics]])
               :  +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, time_dim]])
               +- LogicalTableScan(table=[[hive, tpcds_bin_partitioned_orc_10000, store]])
]]>
    </Resource>
    <Resource name="optimized exec plan">
      <![CDATA[
Calc(select=[h8_30_to_9, h9_to_9_30, h9_30_to_10, h10_to_10_30, h10_30_to_11, h11_to_11_30, h11_30_to_12, h12_to_12_30])
+- NestedLoopJoin(joinType=[InnerJoin], where=[true], select=[h8_30_to_9, h12_to_12_30, h11_30_to_12, h11_to_11_30, h10_30_to_11, h10_to_10_30, h9_30_to_10, h9_to_9_30], build=[right], singleRowJoin=[true])
   :- NestedLoopJoin(joinType=[InnerJoin], where=[true], select=[h8_30_to_9, h12_to_12_30, h11_30_to_12, h11_to_11_30, h10_30_to_11, h10_to_10_30, h9_30_to_10], build=[right], singleRowJoin=[true])
   :  :- NestedLoopJoin(joinType=[InnerJoin], where=[true], select=[h8_30_to_9, h12_to_12_30, h11_30_to_12, h11_to_11_30, h10_30_to_11, h10_to_10_30], build=[right], singleRowJoin=[true])
   :  :  :- NestedLoopJoin(joinType=[InnerJoin], where=[true], select=[h8_30_to_9, h12_to_12_30, h11_30_to_12, h11_to_11_30, h10_30_to_11], build=[right], singleRowJoin=[true])
   :  :  :  :- NestedLoopJoin(joinType=[InnerJoin], where=[true], select=[h8_30_to_9, h12_to_12_30, h11_30_to_12, h11_to_11_30], build=[right], singleRowJoin=[true])
   :  :  :  :  :- NestedLoopJoin(joinType=[InnerJoin], where=[true], select=[h8_30_to_9, h12_to_12_30, h11_30_to_12], build=[right], singleRowJoin=[true])
   :  :  :  :  :  :- NestedLoopJoin(joinType=[InnerJoin], where=[true], select=[h8_30_to_9, h12_to_12_30], build=[left], singleRowJoin=[true])
   :  :  :  :  :  :  :- Exchange(distribution=[broadcast])
   :  :  :  :  :  :  :  +- HashAggregate(isMerge=[true], select=[Final_COUNT(count1$0) AS h8_30_to_9])
   :  :  :  :  :  :  :     +- Exchange(distribution=[single])
   :  :  :  :  :  :  :        +- LocalHashAggregate(select=[Partial_COUNT(*) AS count1$0])
   :  :  :  :  :  :  :           +- Calc(select=[0 AS $f0])
   :  :  :  :  :  :  :              +- HashJoin(joinType=[InnerJoin], where=[(ss_store_sk = s_store_sk)], select=[ss_store_sk, s_store_sk], isBroadcast=[true], build=[right])
   :  :  :  :  :  :  :                 :- Calc(select=[ss_store_sk])
   :  :  :  :  :  :  :                 :  +- HashJoin(joinType=[InnerJoin], where=[(ss_hdemo_sk = hd_demo_sk)], select=[ss_hdemo_sk, ss_store_sk, hd_demo_sk], isBroadcast=[true], build=[right])
   :  :  :  :  :  :  :                 :     :- Calc(select=[ss_hdemo_sk, ss_store_sk])
   :  :  :  :  :  :  :                 :     :  +- HashJoin(joinType=[InnerJoin], where=[(ss_sold_time_sk = t_time_sk)], select=[ss_sold_time_sk, ss_hdemo_sk, ss_store_sk, t_time_sk], isBroadcast=[true], build=[right])
   :  :  :  :  :  :  :                 :     :     :- Calc(select=[ss_sold_time_sk, ss_hdemo_sk, ss_store_sk], where=[ss_hdemo_sk IS NOT NULL])(reuse_id=[1])
   :  :  :  :  :  :  :                 :     :     :  +- TableSourceScan(table=[[hive, tpcds_bin_partitioned_orc_10000, store_sales, project=[ss_sold_time_sk, ss_hdemo_sk, ss_store_sk]]], fields=[ss_sold_time_sk, ss_hdemo_sk, ss_store_sk])
   :  :  :  :  :  :  :                 :     :     +- Exchange(distribution=[broadcast])
   :  :  :  :  :  :  :                 :     :        +- Calc(select=[t_time_sk], where=[((t_hour = 8) AND (t_minute >= 30))])
   :  :  :  :  :  :  :                 :     :           +- TableSourceScan(table=[[hive, tpcds_bin_partitioned_orc_10000, time_dim, project=[t_time_sk, t_hour, t_minute]]], fields=[t_time_sk, t_hour, t_minute])(reuse_id=[2])
   :  :  :  :  :  :  :                 :     +- Exchange(distribution=[broadcast])(reuse_id=[3])
   :  :  :  :  :  :  :                 :        +- Calc(select=[hd_demo_sk], where=[(((hd_dep_count = 3) AND (hd_vehicle_count <= 5)) OR ((hd_dep_count = 0) AND (hd_vehicle_count <= 2)) OR ((hd_dep_count = 1) AND (hd_vehicle_count <= 3)))])
   :  :  :  :  :  :  :                 :           +- TableSourceScan(table=[[hive, tpcds_bin_partitioned_orc_10000, household_demographics, project=[hd_demo_sk, hd_dep_count, hd_vehicle_count]]], fields=[hd_demo_sk, hd_dep_count, hd_vehicle_count])
   :  :  :  :  :  :  :                 +- Exchange(distribution=[broadcast])(reuse_id=[4])
   :  :  :  :  :  :  :                    +- Calc(select=[s_store_sk], where=[(s_store_name = 'ese')])
   :  :  :  :  :  :  :                       +- TableSourceScan(table=[[hive, tpcds_bin_partitioned_orc_10000, store, project=[s_store_sk, s_store_name]]], fields=[s_store_sk, s_store_name])
   :  :  :  :  :  :  +- HashAggregate(isMerge=[true], select=[Final_COUNT(count1$0) AS h12_to_12_30])
   :  :  :  :  :  :     +- Exchange(distribution=[single])
   :  :  :  :  :  :        +- LocalHashAggregate(select=[Partial_COUNT(*) AS count1$0])
   :  :  :  :  :  :           +- Calc(select=[0 AS $f0])
   :  :  :  :  :  :              +- HashJoin(joinType=[InnerJoin], where=[(ss_store_sk = s_store_sk)], select=[ss_store_sk, s_store_sk], isBroadcast=[true], build=[right])
   :  :  :  :  :  :                 :- Calc(select=[ss_store_sk])
   :  :  :  :  :  :                 :  +- HashJoin(joinType=[InnerJoin], where=[(ss_hdemo_sk = hd_demo_sk)], select=[ss_hdemo_sk, ss_store_sk, hd_demo_sk], isBroadcast=[true], build=[right])
   :  :  :  :  :  :                 :     :- Calc(select=[ss_hdemo_sk, ss_store_sk])
   :  :  :  :  :  :                 :     :  +- HashJoin(joinType=[InnerJoin], where=[(ss_sold_time_sk = t_time_sk)], select=[ss_sold_time_sk, ss_hdemo_sk, ss_store_sk, t_time_sk], isBroadcast=[true], build=[right])
   :  :  :  :  :  :                 :     :     :- Reused(reference_id=[1])
   :  :  :  :  :  :                 :     :     +- Exchange(distribution=[broadcast])
   :  :  :  :  :  :                 :     :        +- Calc(select=[t_time_sk], where=[((t_hour = 12) AND (t_minute < 30))])
   :  :  :  :  :  :                 :     :           +- Reused(reference_id=[2])
   :  :  :  :  :  :                 :     +- Reused(reference_id=[3])
   :  :  :  :  :  :                 +- Reused(reference_id=[4])
   :  :  :  :  :  +- Exchange(distribution=[broadcast])
   :  :  :  :  :     +- HashAggregate(isMerge=[true], select=[Final_COUNT(count1$0) AS h11_30_to_12])
   :  :  :  :  :        +- Exchange(distribution=[single])
   :  :  :  :  :           +- LocalHashAggregate(select=[Partial_COUNT(*) AS count1$0])
   :  :  :  :  :              +- Calc(select=[0 AS $f0])
   :  :  :  :  :                 +- HashJoin(joinType=[InnerJoin], where=[(ss_store_sk = s_store_sk)], select=[ss_store_sk, s_store_sk], isBroadcast=[true], build=[right])
   :  :  :  :  :                    :- Calc(select=[ss_store_sk])
   :  :  :  :  :                    :  +- HashJoin(joinType=[InnerJoin], where=[(ss_hdemo_sk = hd_demo_sk)], select=[ss_hdemo_sk, ss_store_sk, hd_demo_sk], isBroadcast=[true], build=[right])
   :  :  :  :  :                    :     :- Calc(select=[ss_hdemo_sk, ss_store_sk])
   :  :  :  :  :                    :     :  +- HashJoin(joinType=[InnerJoin], where=[(ss_sold_time_sk = t_time_sk)], select=[ss_sold_time_sk, ss_hdemo_sk, ss_store_sk, t_time_sk], isBroadcast=[true], build=[right])
   :  :  :  :  :                    :     :     :- Reused(reference_id=[1])
   :  :  :  :  :                    :     :     +- Exchange(distribution=[broadcast])
   :  :  :  :  :                    :     :        +- Calc(select=[t_time_sk], where=[((t_hour = 11) AND (t_minute >= 30))])
   :  :  :  :  :                    :     :           +- Reused(reference_id=[2])
   :  :  :  :  :                    :     +- Reused(reference_id=[3])
   :  :  :  :  :                    +- Reused(reference_id=[4])
   :  :  :  :  +- Exchange(distribution=[broadcast])
   :  :  :  :     +- HashAggregate(isMerge=[true], select=[Final_COUNT(count1$0) AS h11_to_11_30])
   :  :  :  :        +- Exchange(distribution=[single])
   :  :  :  :           +- LocalHashAggregate(select=[Partial_COUNT(*) AS count1$0])
   :  :  :  :              +- Calc(select=[0 AS $f0])
   :  :  :  :                 +- HashJoin(joinType=[InnerJoin], where=[(ss_store_sk = s_store_sk)], select=[ss_store_sk, s_store_sk], isBroadcast=[true], build=[right])
   :  :  :  :                    :- Calc(select=[ss_store_sk])
   :  :  :  :                    :  +- HashJoin(joinType=[InnerJoin], where=[(ss_hdemo_sk = hd_demo_sk)], select=[ss_hdemo_sk, ss_store_sk, hd_demo_sk], isBroadcast=[true], build=[right])
   :  :  :  :                    :     :- Calc(select=[ss_hdemo_sk, ss_store_sk])
   :  :  :  :                    :     :  +- HashJoin(joinType=[InnerJoin], where=[(ss_sold_time_sk = t_time_sk)], select=[ss_sold_time_sk, ss_hdemo_sk, ss_store_sk, t_time_sk], isBroadcast=[true], build=[right])
   :  :  :  :                    :     :     :- Reused(reference_id=[1])
   :  :  :  :                    :     :     +- Exchange(distribution=[broadcast])
   :  :  :  :                    :     :        +- Calc(select=[t_time_sk], where=[((t_hour = 11) AND (t_minute < 30))])
   :  :  :  :                    :     :           +- Reused(reference_id=[2])
   :  :  :  :                    :     +- Reused(reference_id=[3])
   :  :  :  :                    +- Reused(reference_id=[4])
   :  :  :  +- Exchange(distribution=[broadcast])
   :  :  :     +- HashAggregate(isMerge=[true], select=[Final_COUNT(count1$0) AS h10_30_to_11])
   :  :  :        +- Exchange(distribution=[single])
   :  :  :           +- LocalHashAggregate(select=[Partial_COUNT(*) AS count1$0])
   :  :  :              +- Calc(select=[0 AS $f0])
   :  :  :                 +- HashJoin(joinType=[InnerJoin], where=[(ss_store_sk = s_store_sk)], select=[ss_store_sk, s_store_sk], isBroadcast=[true], build=[right])
   :  :  :                    :- Calc(select=[ss_store_sk])
   :  :  :                    :  +- HashJoin(joinType=[InnerJoin], where=[(ss_hdemo_sk = hd_demo_sk)], select=[ss_hdemo_sk, ss_store_sk, hd_demo_sk], isBroadcast=[true], build=[right])
   :  :  :                    :     :- Calc(select=[ss_hdemo_sk, ss_store_sk])
   :  :  :                    :     :  +- HashJoin(joinType=[InnerJoin], where=[(ss_sold_time_sk = t_time_sk)], select=[ss_sold_time_sk, ss_hdemo_sk, ss_store_sk, t_time_sk], isBroadcast=[true], build=[right])
   :  :  :                    :     :     :- Reused(reference_id=[1])
   :  :  :                    :     :     +- Exchange(distribution=[broadcast])
   :  :  :                    :     :        +- Calc(select=[t_time_sk], where=[((t_hour = 10) AND (t_minute >= 30))])
   :  :  :                    :     :           +- Reused(reference_id=[2])
   :  :  :                    :     +- Reused(reference_id=[3])
   :  :  :                    +- Reused(reference_id=[4])
   :  :  +- Exchange(distribution=[broadcast])
   :  :     +- HashAggregate(isMerge=[true], select=[Final_COUNT(count1$0) AS h10_to_10_30])
   :  :        +- Exchange(distribution=[single])
   :  :           +- LocalHashAggregate(select=[Partial_COUNT(*) AS count1$0])
   :  :              +- Calc(select=[0 AS $f0])
   :  :                 +- HashJoin(joinType=[InnerJoin], where=[(ss_store_sk = s_store_sk)], select=[ss_store_sk, s_store_sk], isBroadcast=[true], build=[right])
   :  :                    :- Calc(select=[ss_store_sk])
   :  :                    :  +- HashJoin(joinType=[InnerJoin], where=[(ss_hdemo_sk = hd_demo_sk)], select=[ss_hdemo_sk, ss_store_sk, hd_demo_sk], isBroadcast=[true], build=[right])
   :  :                    :     :- Calc(select=[ss_hdemo_sk, ss_store_sk])
   :  :                    :     :  +- HashJoin(joinType=[InnerJoin], where=[(ss_sold_time_sk = t_time_sk)], select=[ss_sold_time_sk, ss_hdemo_sk, ss_store_sk, t_time_sk], isBroadcast=[true], build=[right])
   :  :                    :     :     :- Reused(reference_id=[1])
   :  :                    :     :     +- Exchange(distribution=[broadcast])
   :  :                    :     :        +- Calc(select=[t_time_sk], where=[((t_hour = 10) AND (t_minute < 30))])
   :  :                    :     :           +- Reused(reference_id=[2])
   :  :                    :     +- Reused(reference_id=[3])
   :  :                    +- Reused(reference_id=[4])
   :  +- Exchange(distribution=[broadcast])
   :     +- HashAggregate(isMerge=[true], select=[Final_COUNT(count1$0) AS h9_30_to_10])
   :        +- Exchange(distribution=[single])
   :           +- LocalHashAggregate(select=[Partial_COUNT(*) AS count1$0])
   :              +- Calc(select=[0 AS $f0])
   :                 +- HashJoin(joinType=[InnerJoin], where=[(ss_store_sk = s_store_sk)], select=[ss_store_sk, s_store_sk], isBroadcast=[true], build=[right])
   :                    :- Calc(select=[ss_store_sk])
   :                    :  +- HashJoin(joinType=[InnerJoin], where=[(ss_hdemo_sk = hd_demo_sk)], select=[ss_hdemo_sk, ss_store_sk, hd_demo_sk], isBroadcast=[true], build=[right])
   :                    :     :- Calc(select=[ss_hdemo_sk, ss_store_sk])
   :                    :     :  +- HashJoin(joinType=[InnerJoin], where=[(ss_sold_time_sk = t_time_sk)], select=[ss_sold_time_sk, ss_hdemo_sk, ss_store_sk, t_time_sk], isBroadcast=[true], build=[right])
   :                    :     :     :- Reused(reference_id=[1])
   :                    :     :     +- Exchange(distribution=[broadcast])
   :                    :     :        +- Calc(select=[t_time_sk], where=[((t_hour = 9) AND (t_minute >= 30))])
   :                    :     :           +- Reused(reference_id=[2])
   :                    :     +- Reused(reference_id=[3])
   :                    +- Reused(reference_id=[4])
   +- Exchange(distribution=[broadcast])
      +- HashAggregate(isMerge=[true], select=[Final_COUNT(count1$0) AS h9_to_9_30])
         +- Exchange(distribution=[single])
            +- LocalHashAggregate(select=[Partial_COUNT(*) AS count1$0])
               +- Calc(select=[0 AS $f0])
                  +- HashJoin(joinType=[InnerJoin], where=[(ss_store_sk = s_store_sk)], select=[ss_store_sk, s_store_sk], isBroadcast=[true], build=[right])
                     :- Calc(select=[ss_store_sk])
                     :  +- HashJoin(joinType=[InnerJoin], where=[(ss_hdemo_sk = hd_demo_sk)], select=[ss_hdemo_sk, ss_store_sk, hd_demo_sk], isBroadcast=[true], build=[right])
                     :     :- Calc(select=[ss_hdemo_sk, ss_store_sk])
                     :     :  +- HashJoin(joinType=[InnerJoin], where=[(ss_sold_time_sk = t_time_sk)], select=[ss_sold_time_sk, ss_hdemo_sk, ss_store_sk, t_time_sk], isBroadcast=[true], build=[right])
                     :     :     :- Reused(reference_id=[1])
                     :     :     +- Exchange(distribution=[broadcast])
                     :     :        +- Calc(select=[t_time_sk], where=[((t_hour = 9) AND (t_minute < 30))])
                     :     :           +- Reused(reference_id=[2])
                     :     +- Reused(reference_id=[3])
                     +- Reused(reference_id=[4])
]]>
    </Resource>
  </TestCase>
